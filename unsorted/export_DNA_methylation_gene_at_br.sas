
libname arabRNA '!HOME/concannon/DTRA/arabidopsis/sas_data';
libname arabMAP '/TB14/TB14/sandbox/dtra_sandbox/arab_wgbs';
libname brassRNA '!HOME/concannon/DTRA/brassica/sas_data';
libname brassMAP '/TB14/TB14/sandbox/dtra_sandbox/brass_wgbs';

ods html close;
ods listing;

proc datasets kill lib=work  noprint;
run;
quit;



data  meth_deg_at;
  set arabRNA.arab_results_by_gene;
  where gene_id in ('AT4G19020','AT4G26170','AT5G14620','AT2G32940','AT2G40030','AT3G22680','AT2G16390','AT5G49160','AT2G27040','AT2G36490','AT3G17310','AT1G15215','AT3G49250','AT3G48670','AT5G49160','AT2G27040','AT4G14140','AT5G56780','AT5G14620','AT5G04560','AT5G04290','AT1G69770','AT1G80740','AT2G30280','AT2G35670','AT3G23780','AT4G08990','AT4G13610','AT5G01675','AT5G15380','AT1G05910','AT1G08130','AT1G54840','AT1G72270','AT1G80420','AT2G22260','AT3G14890','AT3G15120','AT4G31270','AT4G36050','AT5G58130')
;
 keep gene_id fdr_: mean_cpm_: ;
run;

data meth_dag_at;
  set arabMAP.results_by_dar_annot;
   where geneID in ('AT4G19020','AT4G26170','AT5G14620','AT2G32940','AT2G40030','AT3G22680','AT2G16390','AT5G49160','AT2G27040','AT2G36490','AT3G17310','AT1G15215','AT3G49250','AT3G48670','AT5G49160','AT2G27040','AT4G14140','AT5G56780','AT5G14620','AT5G04560','AT5G04290','AT1G69770','AT1G80740','AT2G30280','AT2G35670','AT3G23780','AT4G08990','AT4G13610','AT5G01675','AT5G15380','AT1G05910','AT1G08130','AT1G54840','AT1G72270','AT1G80420','AT2G22260','AT3G14890','AT3G15120','AT4G31270','AT4G36050','AT5G58130')
;

run; 

data meth_dmg_at;
  set arabMAP.results_by_dmr_annot;
   where geneID in ('AT4G19020','AT4G26170','AT5G14620','AT2G32940','AT2G40030','AT3G22680','AT2G16390','AT5G49160','AT2G27040','AT2G36490','AT3G17310','AT1G15215','AT3G49250','AT3G48670','AT5G49160','AT2G27040','AT4G14140','AT5G56780','AT5G14620','AT5G04560','AT5G04290','AT1G69770','AT1G80740','AT2G30280','AT2G35670','AT3G23780','AT4G08990','AT4G13610','AT5G01675','AT5G15380','AT1G05910','AT1G08130','AT1G54840','AT1G72270','AT1G80420','AT2G22260','AT3G14890','AT3G15120','AT4G31270','AT4G36050','AT5G58130')
;


run; 

data meth_dmg_at2;
  set meth_dmg_at;
  where flag_binomial_fdr05=1 or num_sites_FDR05 > 0;
run;



data  meth_deg_br;
  set brassRNA.results_by_gene;
   where gene_ID in ('BraA01g03230R_gene','BraA01g09770R_gene','BraA02g06530R_gene','BraA02g06550R_gene','BraA03g17230R_gene','BraA03g20850R_gene','BraA03g39770R_gene',
'BraA03g43660R_gene','BraA03g43680R_gene','BraA04g16300R_gene','BraA04g18810R_gene','BraA04g18820R_gene','BraA05g09310R_gene','BraA05g28670R_gene','BraA06g11080R_gene',
'BraA06g17530R_gene','BraA06g18090R_gene','BraA06g23210R_gene','BraA06g32750R_gene','BraA07g16630R_gene','BraA09g52360R_gene','BraA10g13980R_gene','BraA10g23200R_gene',
'BraA10g23210R_gene','BraA10g29990R_gene','BraA10g30250R_gene','BraA09g63530R_gene','BraA09g63540R_gene','BraA10g05140R_gene','BraA06g05710R_gene','BraA09g62490R_gene',
'BraA01g18590R_gene','BraA09g52880R_gene','BraA03g36230R_gene','BraA03g36370R_gene','BraA08g17640R_gene','BraA10g15230R_gene');
run;

data meth_dag_br;
  set brassMAP.results_by_dar_annot;
   where geneID in ('PARENT=BRAA01G03230R','PARENT=BRAA01G09770R','PARENT=BRAA02G06530R','PARENT=BRAA02G06550R','PARENT=BRAA03G17230R','PARENT=BRAA03G20850R','PARENT=BRAA03G39770R',
'PARENT=BRAA03G43660R','PARENT=BRAA03G43680R','PARENT=BRAA04G16300R','PARENT=BRAA04G18810R','PARENT=BRAA04G18820R','PARENT=BRAA05G09310R','PARENT=BRAA05G28670R','PARENT=BRAA06G11080R',
'PARENT=BRAA06G17530R','PARENT=BRAA06G18090R','PARENT=BRAA06G23210R','PARENT=BRAA06G32750R','PARENT=BRAA07G16630R','PARENT=BRAA09G52360R','PARENT=BRAA10G13980R','PARENT=BRAA10G23200R',
'PARENT=BRAA10G23210R','PARENT=BRAA10G29990R','PARENT=BRAA10G30250R','PARENT=BRAA09G63530R','PARENT=BRAA09G63540R','PARENT=BRAA10G05140R','PARENT=BRAA06G05710R','PARENT=BRAA09G62490R',
'PARENT=BRAA01G18590R','PARENT=BRAA09G52880R','PARENT=BRAA03G36230R','PARENT=BRAA03G36370R','PARENT=BRAA08G17640R','PARENT=BRAA10G15230R');
run;

data meth_dmg_br;
  set brassMAP.results_by_dmr_annot;
   where geneID in ('PARENT=BRAA01G03230R','PARENT=BRAA01G09770R','PARENT=BRAA02G06530R','PARENT=BRAA02G06550R','PARENT=BRAA03G17230R','PARENT=BRAA03G20850R','PARENT=BRAA03G39770R',
'PARENT=BRAA03G43660R','PARENT=BRAA03G43680R','PARENT=BRAA04G16300R','PARENT=BRAA04G18810R','PARENT=BRAA04G18820R','PARENT=BRAA05G09310R','PARENT=BRAA05G28670R','PARENT=BRAA06G11080R',
'PARENT=BRAA06G17530R','PARENT=BRAA06G18090R','PARENT=BRAA06G23210R','PARENT=BRAA06G32750R','PARENT=BRAA07G16630R','PARENT=BRAA09G52360R','PARENT=BRAA10G13980R','PARENT=BRAA10G23200R',
'PARENT=BRAA10G23210R','PARENT=BRAA10G29990R','PARENT=BRAA10G30250R','PARENT=BRAA09G63530R','PARENT=BRAA09G63540R','PARENT=BRAA10G05140R','PARENT=BRAA06G05710R','PARENT=BRAA09G62490R',
'PARENT=BRAA01G18590R','PARENT=BRAA09G52880R','PARENT=BRAA03G36230R','PARENT=BRAA03G36370R','PARENT=BRAA08G17640R','PARENT=BRAA10G15230R');
run;




proc export data=meth_deg_at outfile="!HOME/concannon/DTRA/methylation_genes_DEG_At.csv"
    dmbs=csv replace;
run;

proc export data=meth_dmg_at outfile="!HOME/concannon/DTRA/methylation_genes_DMR_At.csv"
    dmbs=csv replace;
run;

proc export data=meth_dag_at outfile="!HOME/concannon/DTRA/methylation_genes_DAR_At.csv"
    dmbs=csv replace;
run;


proc export data=meth_deg_br outfile="!HOME/concannon/DTRA/methylation_genes_DEG_Br.csv"
    dmbs=csv replace;
run;

proc export data=meth_dmg_br outfile="!HOME/concannon/DTRA/methylation_genes_DMR_Br.csv"
    dmbs=csv replace;
run;

proc export data=meth_dag_br outfile="!HOME/concannon/DTRA/methylation_genes_DAR_Br.csv"
    dmbs=csv replace;
run;





