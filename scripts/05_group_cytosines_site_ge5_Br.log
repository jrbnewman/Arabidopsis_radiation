1                                                          The SAS System                               13:30 Monday, April 17, 2023

NOTE: Copyright (c) 2002-2012 by SAS Institute Inc., Cary, NC, USA. 
NOTE: SAS (r) Proprietary Software 9.4 (TS1M1 MBCS3170) 
      Licensed to UNIVERSITY OF FLORIDA - SFA T&R, Site 70095659.
NOTE: This session is executing on the Linux 3.10.0-1160.80.1.el7.x86_64 (LIN X64) platform.



NOTE: Updated analytical products:
      
      SAS/STAT 13.1
      SAS/ETS 13.1
      SAS/OR 13.1
      SAS/IML 13.1
      SAS/QC 13.1

NOTE: Additional host information:

 Linux LIN X64 3.10.0-1160.80.1.el7.x86_64 #1 SMP Sat Oct 8 18:13:21 UTC 2022 x86_64 Red Hat Enterprise Linux Server release 7.9 
      (Maipo) 

You are running SAS 9. Some SAS 8 files will be automatically converted 
by the V9 engine; others are incompatible.  Please see 
http://support.sas.com/rnd/migration/planning/platform/64bit.html

PROC MIGRATE will preserve current SAS file attributes and is 
recommended for converting all your SAS libraries from any 
SAS 8 release to SAS 9.  For details and examples, please see
http://support.sas.com/rnd/migration/index.html


This message is contained in the SAS news file, and is presented upon
initialization.  Edit the file "news" in the "misc/base" directory to
display site-specific news and information in the program log.
The command line option "-nonews" will prevent this display.




NOTE: SAS initialization used:
      real time           3.28 seconds
      cpu time            0.02 seconds
      
1          
2          *libname wgbsB '!HOME/concannon/DTRA/brassica_emseq/sas_data';
3          *libname wgbslocB '/TB14/TB14/sandbox/dtra_sandbox/brass_wgbs';
4          *libname wgbslocL '/TB14/TB14/sandbox/idaho_sandbox/brass_long_wgbs';
5          
6          libname wgbslocB '/blue/concannon/share/jrbnewman/idaho/brassica_wgbs_sas_data';
NOTE: Libref WGBSLOCB was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: /blue/concannon/share/jrbnewman/idaho/brassica_wgbs_sas_data
7          libname wgbslocL '/blue/concannon/share/jrbnewman/idaho/brassica_longday_wgbs_sas_data';
NOTE: Libref WGBSLOCL was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: /blue/concannon/share/jrbnewman/idaho/brassica_longday_wgbs_sas_data
8          
9          
10         
2                                                          The SAS System                               13:30 Monday, April 17, 2023

11         
12         ods listing;
13         ods html close;
14         
15         proc datasets lib=work kill noprint;
16         run;

17         quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

18         
19         /* FDR - DMCs and DACs */
20         
21         
22         data all_dmc;
23            set wgbslocB.dmc_brass_10cGy1h_0cGy1h (in=in1)
24                wgbslocB.dmc_brass_1p4cGy1h_0cGy1h (in=in2)
25                wgbslocB.dmc_brass_10cGy72h_0cGy72h (in=in3)
26                wgbslocB.dmc_brass_1p4cGy72h_0cGy72h (in=in4)
27                wgbslocB.dmc_long_1p4cGy72h_0cGy72h (in=in5);
28            length comparison $32.;
29            if in1 then comparison=compress("brass_10cGy_0cGy_1h");
30            if in2 then comparison=compress("brass_1p4cGy_0cGy_1h");
31            if in3 then comparison=compress("brass_10cGy_0cGy_72h");
32            if in4 then comparison=compress("brass_1p4cGy_0cGy_72h");
33            if in5 then comparison=compress("long_1p4cGy_0cGy_72h");
34            if XP2_FISH = . then delete;
35         run;

NOTE: There were 47442694 observations read from the data set WGBSLOCB.DMC_BRASS_10CGY1H_0CGY1H.
NOTE: There were 45711020 observations read from the data set WGBSLOCB.DMC_BRASS_1P4CGY1H_0CGY1H.
NOTE: There were 53917380 observations read from the data set WGBSLOCB.DMC_BRASS_10CGY72H_0CGY72H.
NOTE: There were 62394426 observations read from the data set WGBSLOCB.DMC_BRASS_1P4CGY72H_0CGY72H.
NOTE: There were 90392002 observations read from the data set WGBSLOCB.DMC_LONG_1P4CGY72H_0CGY72H.
NOTE: The data set WORK.ALL_DMC has 149928761 observations and 104 variables.
NOTE: DATA statement used (Total process time):
      real time           4:21.77
      cpu time            4:15.55
      

36         
37         data check;
38           set all_dmc;
39           where XP2_FISH < 0.05;
40          keep comparison;
41         run;

NOTE: There were 2638738 observations read from the data set WORK.ALL_DMC.
      WHERE XP2_FISH<0.05;
NOTE: The data set WORK.CHECK has 2638738 observations and 1 variables.
NOTE: DATA statement used (Total process time):
      real time           47.81 seconds
      cpu time            39.59 seconds
      
3                                                          The SAS System                               13:30 Monday, April 17, 2023


42         
43         proc freq data=check;
44          tables comparison;
45         run;

NOTE: There were 2638738 observations read from the data set WORK.CHECK.
NOTE: The PROCEDURE FREQ printed page 1.
NOTE: PROCEDURE FREQ used (Total process time):
      real time           0.45 seconds
      cpu time            0.35 seconds
      

46         
47         
48         
49         proc sort data=all_dmc nodup;
50            by comparison site_type XP2_FISH chr start_pos stop_pos ;
51         run;

NOTE: There were 149928761 observations read from the data set WORK.ALL_DMC.
NOTE: 0 duplicate observations were deleted.
NOTE: The data set WORK.ALL_DMC has 149928761 observations and 104 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           17:16.03
      cpu time            17:09.83
      

52         
53         proc multtest inpvalues(XP2_FISH)=all_dmc fdr noprint out=all_dmc_fdr;
54         by  comparison site_type;
55         run;

NOTE: There were 149928761 observations read from the data set WORK.ALL_DMC.
NOTE: The data set WORK.ALL_DMC_FDR has 149928761 observations and 105 variables.
NOTE: PROCEDURE MULTTEST used (Total process time):
      real time           5:40.95
      cpu time            5:27.45
      

56         
57         data all_dmc_fdr2;
58           set all_dmc_fdr;
59           if fdr_p = . then flag_fet_fdr05=.; else if fdr_p < 0.05 then flag_fet_fdr05=1; else flag_fet_fdr05=0;
60           rename XP2_FISH=FET_P fdr_p=FET_FDR_P;
61         run;

NOTE: There were 149928761 observations read from the data set WORK.ALL_DMC_FDR.
NOTE: The data set WORK.ALL_DMC_FDR2 has 149928761 observations and 106 variables.
NOTE: DATA statement used (Total process time):
      real time           3:45.13
      cpu time            3:29.15
      

62         
63         proc freq data=all_dmc_fdr2 noprint;
64          tables flag_fet_fdr05*comparison / out=check;

4                                                          The SAS System                               13:30 Monday, April 17, 2023

NOTE: There were 149928761 observations read from the data set WORK.ALL_DMC_FDR2.
NOTE: The data set WORK.CHECK has 10 observations and 4 variables.
NOTE: PROCEDURE FREQ used (Total process time):
      real time           1:13.63
      cpu time            1:08.93
      

65         proc print data=check;
66         run;

NOTE: There were 10 observations read from the data set WORK.CHECK.
NOTE: The PROCEDURE PRINT printed page 2.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.02 seconds
      cpu time            0.00 seconds
      

67         
68         
69         /* Need to get methylation rates and calculate differences */
70         
71         data methyl_data;
72             set wgbslocB.methylation_data_cg_chg_chh (in=in1)
73                 wgbslocL.methylation_data_cg_chg_chh (in=in2);
NOTE: Data file WGBSLOCB.METHYLATION_DATA_CG_CHG_CHH.DATA is in a format that is native to another host, or the file encoding does 
      not match the session encoding. Cross Environment Data Access will be used, which might require additional CPU resources and 
      might reduce performance.
74             length project $12.;
75             if chr="Mt" or chr="Pt" then delete;
76             if in1 then project = "brass";
77             if in2 then project = "long";
78             if in2 then time = "72h";
79             if treatment = "1_4cGy" then treatment = "1p4cGy";
80         run;

NOTE: There were 1269616683 observations read from the data set WGBSLOCB.METHYLATION_DATA_CG_CHG_CHH.
NOTE: There were 422083600 observations read from the data set WGBSLOCL.METHYLATION_DATA_CG_CHG_CHH.
NOTE: The data set WORK.METHYL_DATA has 1691700283 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           27:07.55
      cpu time            26:34.97
      

81         
82         proc sort data=methyl_data;
83            by chr start_pos stop_pos site_type project treatment time units;

NOTE: There were 1691700283 observations read from the data set WORK.METHYL_DATA.
NOTE: The data set WORK.METHYL_DATA has 1691700283 observations and 12 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           50:42.73
      cpu time            50:14.74
      

84         proc means data=methyl_data noprint;
85            by chr start_pos stop_pos site_type project treatment time units;
86            var total_C perc_methyl;
87            output out=methyl_perc sum(total_C)=total_C mean(perc_methyl)=perc_methyl;
5                                                          The SAS System                               13:30 Monday, April 17, 2023

88         run;

NOTE: There were 1691700283 observations read from the data set WORK.METHYL_DATA.
NOTE: The data set WORK.METHYL_PERC has 874518708 observations and 12 variables.
NOTE: PROCEDURE MEANS used (Total process time):
      real time           18:03.51
      cpu time            17:57.18
      

89         
90         data methyl_perc2;
91           set methyl_perc;
92           if total_C < 10 then delete;
93         run;

NOTE: There were 874518708 observations read from the data set WORK.METHYL_PERC.
NOTE: The data set WORK.METHYL_PERC2 has 700980611 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           2:31.79
      cpu time            2:30.91
      

94         
95         
96         proc sort data=methyl_perc2;
97            by project time site_type chr start_pos stop_pos treatment units;

NOTE: There were 700980611 observations read from the data set WORK.METHYL_PERC2.
NOTE: The data set WORK.METHYL_PERC2 has 700980611 observations and 12 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           11:41.78
      cpu time            11:21.87
      

98         proc transpose data=methyl_perc2 out=methyl_sbys;
99           by project time site_type chr start_pos stop_pos;
100          id treatment units;
101          var perc_methyl;
102        run;

NOTE: There were 700980611 observations read from the data set WORK.METHYL_PERC2.
NOTE: The data set WORK.METHYL_SBYS has 280229534 observations and 10 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           37:47.52
      cpu time            37:27.75
      

103        
104        data methyl_sbys2;
105          set methyl_sbys;
106          if _0cGy0U=. then delete;
107          if _10cGy0U=. and _1p4cGy0U=. then delete;
108          if sum(_0cGy0U, _10cGy0U, _1p4cGy0U) = 0 then delete;
109          drop _NAME_;
110          rename _10cGy0U=methyl_10cGy
111                 _1p4cGy0U=methyl_1p4cGy
112                 _0cGy0U=methyl_0cGy;
113        run;
6                                                          The SAS System                               13:30 Monday, April 17, 2023


NOTE: There were 280229534 observations read from the data set WORK.METHYL_SBYS.
NOTE: The data set WORK.METHYL_SBYS2 has 108155020 observations and 9 variables.
NOTE: DATA statement used (Total process time):
      real time           40.85 seconds
      cpu time            32.58 seconds
      

114        
115        
116        data methyl_sbys2_brass_10cGy_1h;
117           set methyl_sbys2;
118           where project = "brass" and time = "1h";
119           length comparison $32.;
120           if methyl_0cGy=0 and methyl_10cGy=0 then delete;
121           if methyl_0cGy=. or methyl_10cGy=. then delete;
122           comparison=compress("brass_10cGy_0cGy_1h");
123           methyl_diff=methyl_10cGy-methyl_0cGy;
124           drop methyl_1p4cGy;
125           rename methyl_0cGy=methyl_CTL
126                  methyl_10cGy=methyl_TRT;
127         run;

NOTE: There were 27141429 observations read from the data set WORK.METHYL_SBYS2.
      WHERE (project='brass') and (time='1h');
NOTE: The data set WORK.METHYL_SBYS2_BRASS_10CGY_1H has 24367376 observations and 10 variables.
NOTE: DATA statement used (Total process time):
      real time           20.82 seconds
      cpu time            13.81 seconds
      

128        
129        
130        data methyl_sbys2_brass_1p4cGy_1h;
131           set methyl_sbys2;
132           where project = "brass" and time = "1h";
133           length comparison $32.;
134           if methyl_0cGy=0 and methyl_1p4cGy=0 then delete;
135           if methyl_0cGy=. or methyl_1p4cGy=. then delete;
136           comparison=compress("brass_1p4cGy_0cGy_1h");
137           methyl_diff=methyl_1p4cGy-methyl_0cGy;
138           drop methyl_10cGy;
139           rename methyl_0cGy=methyl_CTL
140                  methyl_1p4cGy=methyl_TRT;
141         run;

NOTE: There were 27141429 observations read from the data set WORK.METHYL_SBYS2.
      WHERE (project='brass') and (time='1h');
NOTE: The data set WORK.METHYL_SBYS2_BRASS_1P4CGY_1H has 23606687 observations and 10 variables.
NOTE: DATA statement used (Total process time):
      real time           10.27 seconds
      cpu time            10.22 seconds
      

142        
143        
144        
145        
7                                                          The SAS System                               13:30 Monday, April 17, 2023

146        
147        
148        data methyl_sbys2_brass_10cGy_72h;
149           set methyl_sbys2;
150           where project = "brass" and time = "72h";
151           length comparison $32.;
152           if methyl_0cGy=0 and methyl_10cGy=0 then delete;
153           if methyl_0cGy=. or methyl_10cGy=. then delete;
154           comparison=compress("brass_10cGy_0cGy_72h");
155           methyl_diff=methyl_10cGy-methyl_0cGy;
156           drop methyl_1p4cGy;
157           rename methyl_0cGy=methyl_CTL
158                  methyl_10cGy=methyl_TRT;
159         run;

NOTE: There were 35417391 observations read from the data set WORK.METHYL_SBYS2.
      WHERE (project='brass') and (time='72h');
NOTE: The data set WORK.METHYL_SBYS2_BRASS_10CGY_72H has 27507216 observations and 10 variables.
NOTE: DATA statement used (Total process time):
      real time           11.42 seconds
      cpu time            11.34 seconds
      

160        
161        
162        data methyl_sbys2_brass_1p4cGy_72h;
163           set methyl_sbys2;
164           where project = "brass" and time = "72h";
165           length comparison $32.;
166           if methyl_0cGy=0 and methyl_1p4cGy=0 then delete;
167           if methyl_0cGy=. or methyl_1p4cGy=. then delete;
168           comparison=compress("brass_1p4cGy_0cGy_72h");
169           methyl_diff=methyl_1p4cGy-methyl_0cGy;
170           drop methyl_10cGy;
171           rename methyl_0cGy=methyl_CTL
172                  methyl_1p4cGy=methyl_TRT;
173         run;

NOTE: There were 35417391 observations read from the data set WORK.METHYL_SBYS2.
      WHERE (project='brass') and (time='72h');
NOTE: The data set WORK.METHYL_SBYS2_BRASS_1P4CGY_72H has 31895638 observations and 10 variables.
NOTE: DATA statement used (Total process time):
      real time           13.09 seconds
      cpu time            12.06 seconds
      

174        
175        data methyl_sbys2_long_1p4cGy_72h;
176           set methyl_sbys2;
177           where project = "long";
178           length comparison $32.;
179           if methyl_0cGy=0 and methyl_1p4cGy=0 then delete;
180           if methyl_0cGy=. or methyl_1p4cGy=. then delete;
181           comparison=compress("long_1p4cGy_0cGy_72h");
182           methyl_diff=methyl_1p4cGy-methyl_0cGy;
183           drop methyl_10cGy;
184           rename methyl_0cGy=methyl_CTL
185                  methyl_1p4cGy=methyl_TRT;
8                                                          The SAS System                               13:30 Monday, April 17, 2023

186         run;

NOTE: There were 45596200 observations read from the data set WORK.METHYL_SBYS2.
      WHERE project='long';
NOTE: The data set WORK.METHYL_SBYS2_LONG_1P4CGY_72H has 45596200 observations and 10 variables.
NOTE: DATA statement used (Total process time):
      real time           15.40 seconds
      cpu time            14.32 seconds
      

187        
188        
189        
190        
191        
192        data methyl_sbys2_stack;
193          set methyl_sbys2_brass_10cGy_1h methyl_sbys2_brass_1p4cGy_1h
194              methyl_sbys2_brass_10cGy_72h methyl_sbys2_brass_1p4cGy_72h
195              methyl_sbys2_long_1p4cGy_72h;
196        run;

NOTE: There were 24367376 observations read from the data set WORK.METHYL_SBYS2_BRASS_10CGY_1H.
NOTE: There were 23606687 observations read from the data set WORK.METHYL_SBYS2_BRASS_1P4CGY_1H.
NOTE: There were 27507216 observations read from the data set WORK.METHYL_SBYS2_BRASS_10CGY_72H.
NOTE: There were 31895638 observations read from the data set WORK.METHYL_SBYS2_BRASS_1P4CGY_72H.
NOTE: There were 45596200 observations read from the data set WORK.METHYL_SBYS2_LONG_1P4CGY_72H.
NOTE: The data set WORK.METHYL_SBYS2_STACK has 152973117 observations and 10 variables.
NOTE: DATA statement used (Total process time):
      real time           56.85 seconds
      cpu time            37.92 seconds
      

197        
198        proc freq data=methyl_sbys2_stack;
199        tables comparison;
200        run;

NOTE: There were 152973117 observations read from the data set WORK.METHYL_SBYS2_STACK.
NOTE: The PROCEDURE FREQ printed page 3.
NOTE: PROCEDURE FREQ used (Total process time):
      real time           21.62 seconds
      cpu time            21.21 seconds
      

201        
202        proc freq data=all_dmc_fdr2;
203         tables comparison;
204        run;

NOTE: There were 149928761 observations read from the data set WORK.ALL_DMC_FDR2.
NOTE: The PROCEDURE FREQ printed page 4.
NOTE: PROCEDURE FREQ used (Total process time):
      real time           56.20 seconds
      cpu time            52.74 seconds
      

205        
206        
9                                                          The SAS System                               13:30 Monday, April 17, 2023

207        proc sort data=methyl_sbys2_stack;
208            by comparison site_type chr start_pos stop_pos;

NOTE: There were 152973117 observations read from the data set WORK.METHYL_SBYS2_STACK.
NOTE: The data set WORK.METHYL_SBYS2_STACK has 152973117 observations and 10 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           2:12.53
      cpu time            2:08.04
      

209        proc sort data=all_dmc_fdr2;
210            by comparison site_type chr start_pos stop_pos;
211        run;

NOTE: There were 149928761 observations read from the data set WORK.ALL_DMC_FDR2.
NOTE: The data set WORK.ALL_DMC_FDR2 has 149928761 observations and 106 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           19:13.05
      cpu time            18:22.15
      

212        
213        data methyl_data_all ;
214          merge methyl_sbys2_stack (in=in1) all_dmc_fdr2 (in=in2);
215          by comparison site_type chr start_pos stop_pos;
216          if in1 ;
217        run;

NOTE: There were 152973117 observations read from the data set WORK.METHYL_SBYS2_STACK.
NOTE: There were 149928761 observations read from the data set WORK.ALL_DMC_FDR2.
NOTE: The data set WORK.METHYL_DATA_ALL has 152973117 observations and 111 variables.
NOTE: DATA statement used (Total process time):
      real time           5:02.54
      cpu time            4:55.84
      

218        
219        proc freq data=methyl_data_all;
220         tables comparison;
221        run;

NOTE: There were 152973117 observations read from the data set WORK.METHYL_DATA_ALL.
NOTE: The PROCEDURE FREQ printed page 5.
NOTE: PROCEDURE FREQ used (Total process time):
      real time           1:01.25
      cpu time            55.16 seconds
      

222        
223        
224        data methyl_data_all2;
225          set methyl_data_all;
226          if methyl_diff = . then flag_meth_diff=.;
227          else if methyl_diff > 0 then flag_meth_diff=1;
228          else if methyl_diff < 0 then flag_meth_diff=-1;
229          else flag_meth_diff=0;
230          if abs(methyl_diff) >= 0.1 then flag_meth_diff_10perc=1;
231          else  flag_meth_diff_10perc=0;
10                                                         The SAS System                               13:30 Monday, April 17, 2023

232          if abs(methyl_diff) >= 0.2 then flag_meth_diff_20perc=1;
233          else  flag_meth_diff_20perc=0;
234        run;

NOTE: There were 152973117 observations read from the data set WORK.METHYL_DATA_ALL.
NOTE: The data set WORK.METHYL_DATA_ALL2 has 152973117 observations and 114 variables.
NOTE: DATA statement used (Total process time):
      real time           3:52.27
      cpu time            3:47.43
      

235        
236        
237        proc freq data=methyl_data_all2 noprint;
238        tables comparison*flag_meth_diff_10perc*flag_fet_fdr05 / out=check;

NOTE: There were 152973117 observations read from the data set WORK.METHYL_DATA_ALL2.
NOTE: The data set WORK.CHECK has 23 observations and 5 variables.
NOTE: PROCEDURE FREQ used (Total process time):
      real time           1:39.16
      cpu time            1:24.84
      

239        proc print data=check;
240        run;

NOTE: There were 23 observations read from the data set WORK.CHECK.
NOTE: The PROCEDURE PRINT printed page 6.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.03 seconds
      cpu time            0.00 seconds
      

241        
242        
243        data wgbslocB.results_by_DMC_w_meth_v4;
244            set methyl_Data_all2;
245        run;

NOTE: There were 152973117 observations read from the data set WORK.METHYL_DATA_ALL2.
NOTE: The data set WGBSLOCB.RESULTS_BY_DMC_W_METH_V4 has 152973117 observations and 114 variables.
NOTE: DATA statement used (Total process time):
      real time           3:48.30
      cpu time            3:46.91
      

246        
247        
248        
249        
250        /* Group DMCs into windows
251         Sites must be no more than 100bp away from the next site
252         Sites must have the same direction to be included
253         Region must have at least 3 sites
254         A DMR has at least 3 DMCs (flag 1 and 3)
255         */
256        
257        data dmc;
11                                                         The SAS System                               13:30 Monday, April 17, 2023

258        set  methyl_Data_all2;
259        where flag_meth_diff_10perc=1;
260        run;

NOTE: There were 39533337 observations read from the data set WORK.METHYL_DATA_ALL2.
      WHERE flag_meth_diff_10perc=1;
NOTE: The data set WORK.DMC has 39533337 observations and 114 variables.
NOTE: DATA statement used (Total process time):
      real time           1:44.52
      cpu time            1:32.12
      

261        
262        proc sort data=dmc;
263        by comparison site_type chr start_pos stop_pos;
264        run;

NOTE: There were 39533337 observations read from the data set WORK.DMC.
NOTE: The data set WORK.DMC has 39533337 observations and 114 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           2:54.28
      cpu time            2:49.21
      

265        
266        data group_dmc;
267        retain region_num;
268        set dmc;
269        by comparison site_type chr;
270           prev_pos=lag1(start_pos);
271           prev_direction=lag1(flag_meth_diff);
272           if first.chr then region_num=1;
273           else do;
274           if prev_pos >= start_pos-100 and prev_direction=flag_meth_diff then region_num=region_num;
275          else region_num=region_num + 1;
276         end;
277        run;

NOTE: There were 39533337 observations read from the data set WORK.DMC.
NOTE: The data set WORK.GROUP_DMC has 39533337 observations and 117 variables.
NOTE: DATA statement used (Total process time):
      real time           1:39.33
      cpu time            1:12.47
      

278        
279        
280        proc freq data=group_dmc noprint;
281        tables comparison*site_type*chr*region_num / out=sites_per_region;
282        run;

NOTE: There were 39533337 observations read from the data set WORK.GROUP_DMC.
NOTE: The data set WORK.SITES_PER_REGION has 19014194 observations and 6 variables.
NOTE: PROCEDURE FREQ used (Total process time):
      real time           1:02.94
      cpu time            1:00.37
      

12                                                         The SAS System                               13:30 Monday, April 17, 2023

283        
284        data flag_region_ge2;
285        set sites_per_region;
286        if count >= 2 then flag_num_sites_ge2=1;
287        else flag_num_sites_ge2=0;
288        if count >= 3 then flag_num_sites_ge3=1;
289        else flag_num_sites_ge3=0;
290        if count >= 5 then flag_num_sites_ge5=1;
291        else flag_num_sites_ge5=0;
292        if count >= 10 then flag_num_sites_ge10=1;
293        else flag_num_sites_ge10=0;
294        run;

NOTE: There were 19014194 observations read from the data set WORK.SITES_PER_REGION.
NOTE: The data set WORK.FLAG_REGION_GE2 has 19014194 observations and 10 variables.
NOTE: DATA statement used (Total process time):
      real time           3.98 seconds
      cpu time            3.61 seconds
      

295        
296        proc freq data=flag_region_ge2 noprint;
297        tables comparison*site_type*flaG_num_sites_ge2 / out=dmr_check1;
298        tables comparison*site_type*flaG_num_sites_ge3 / out=dmr_check2;
299        tables comparison*site_type*flaG_num_sites_ge5 / out=dmr_check3;
300        tables comparison*site_type*flaG_num_sites_ge10 / out=dmr_check4;
301        run;

NOTE: There were 19014194 observations read from the data set WORK.FLAG_REGION_GE2.
NOTE: The data set WORK.DMR_CHECK1 has 30 observations and 5 variables.
NOTE: The data set WORK.DMR_CHECK2 has 30 observations and 5 variables.
NOTE: The data set WORK.DMR_CHECK3 has 30 observations and 5 variables.
NOTE: The data set WORK.DMR_CHECK4 has 30 observations and 5 variables.
NOTE: PROCEDURE FREQ used (Total process time):
      real time           9.73 seconds
      cpu time            9.46 seconds
      

302        
303        proc print data=dmr_check1;

NOTE: There were 30 observations read from the data set WORK.DMR_CHECK1.
NOTE: The PROCEDURE PRINT printed page 7.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

304        proc print data=dmr_check2;

NOTE: There were 30 observations read from the data set WORK.DMR_CHECK2.
NOTE: The PROCEDURE PRINT printed page 8.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

305        proc print data=dmr_check3;
13                                                         The SAS System                               13:30 Monday, April 17, 2023


NOTE: There were 30 observations read from the data set WORK.DMR_CHECK3.
NOTE: The PROCEDURE PRINT printed page 9.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

306        proc print data=dmr_check4;
307        run;

NOTE: There were 30 observations read from the data set WORK.DMR_CHECK4.
NOTE: The PROCEDURE PRINT printed page 10.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

308        
309        
310        
311        data region2keep;
312        set flag_region_ge2;
313        where flaG_num_sites_ge5=1;
314        keep comparison site_type chr region_num;
315        run;

NOTE: There were 1588005 observations read from the data set WORK.FLAG_REGION_GE2.
      WHERE flaG_num_sites_ge5=1;
NOTE: The data set WORK.REGION2KEEP has 1588005 observations and 4 variables.
NOTE: DATA statement used (Total process time):
      real time           0.89 seconds
      cpu time            0.86 seconds
      

316        
317        proc sort data=region2keep;
318        by comparison site_type chr region_num;

NOTE: There were 1588005 observations read from the data set WORK.REGION2KEEP.
NOTE: The data set WORK.REGION2KEEP has 1588005 observations and 4 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.77 seconds
      cpu time            0.73 seconds
      

319        proc sort data=group_dmc;
320        by comparison site_type chr region_num;
321        run;

NOTE: There were 39533337 observations read from the data set WORK.GROUP_DMC.
NOTE: The data set WORK.GROUP_DMC has 39533337 observations and 117 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           3:06.81
      cpu time            2:53.63
      

322        
14                                                         The SAS System                               13:30 Monday, April 17, 2023

323        data group_dmc2;
324        merge group_dmc (in=in1) region2keep (in=in2);
325        by comparison site_type chr region_num;
326        if in1 and in2;
327        run;

NOTE: There were 39533337 observations read from the data set WORK.GROUP_DMC.
NOTE: There were 1588005 observations read from the data set WORK.REGION2KEEP.
NOTE: The data set WORK.GROUP_DMC2 has 11444645 observations and 117 variables.
NOTE: DATA statement used (Total process time):
      real time           1:11.21
      cpu time            45.60 seconds
      

328        
329        
330        /* Make permanent */
331        
332        data wgbslocB.cytosine_to_meth_region_index_v4;
333        set group_dmc;
334        run;

NOTE: There were 39533337 observations read from the data set WORK.GROUP_DMC.
NOTE: The data set WGBSLOCB.CYTOSINE_TO_METH_REGION_INDEX_V4 has 39533337 observations and 117 variables.
NOTE: DATA statement used (Total process time):
      real time           1:42.44
      cpu time            1:09.86
      

335        
336        data wgbslocB.meth_region_flag_site_ge5_v4;
337        set flag_region_ge2;
338        run;

NOTE: There were 19014194 observations read from the data set WORK.FLAG_REGION_GE2.
NOTE: The data set WGBSLOCB.METH_REGION_FLAG_SITE_GE5_V4 has 19014194 observations and 10 variables.
NOTE: DATA statement used (Total process time):
      real time           3.52 seconds
      cpu time            3.47 seconds
      

339        
340        
341        data wgbslocB.cytosine_to_meth_region_ge5_v4;
342        set group_dmc2;
343        run;

NOTE: There were 11444645 observations read from the data set WORK.GROUP_DMC2.
NOTE: The data set WGBSLOCB.CYTOSINE_TO_METH_REGION_GE5_V4 has 11444645 observations and 117 variables.
NOTE: DATA statement used (Total process time):
      real time           19.08 seconds
      cpu time            18.04 seconds
      

344        
345        
346        
347        /* DARs
15                                                         The SAS System                               13:30 Monday, April 17, 2023

348        
349        define a DAR as: at least one site with diff > 0.2 and FDR < 0.05, with same differential direction, < 100bp in between
350        
351         */
352        
353        proc datasets lib=work kill noprint;
NOTE: Deleting WORK.ALL_DMC (memtype=DATA).
NOTE: Deleting WORK.ALL_DMC_FDR (memtype=DATA).
NOTE: Deleting WORK.ALL_DMC_FDR2 (memtype=DATA).
NOTE: Deleting WORK.CHECK (memtype=DATA).
NOTE: Deleting WORK.DMC (memtype=DATA).
NOTE: Deleting WORK.DMR_CHECK1 (memtype=DATA).
NOTE: Deleting WORK.DMR_CHECK2 (memtype=DATA).
NOTE: Deleting WORK.DMR_CHECK3 (memtype=DATA).
NOTE: Deleting WORK.DMR_CHECK4 (memtype=DATA).
NOTE: Deleting WORK.FLAG_REGION_GE2 (memtype=DATA).
NOTE: Deleting WORK.GROUP_DMC (memtype=DATA).
NOTE: Deleting WORK.GROUP_DMC2 (memtype=DATA).
NOTE: Deleting WORK.METHYL_DATA (memtype=DATA).
NOTE: Deleting WORK.METHYL_DATA_ALL (memtype=DATA).
NOTE: Deleting WORK.METHYL_DATA_ALL2 (memtype=DATA).
NOTE: Deleting WORK.METHYL_PERC (memtype=DATA).
NOTE: Deleting WORK.METHYL_PERC2 (memtype=DATA).
NOTE: Deleting WORK.METHYL_SBYS (memtype=DATA).
NOTE: Deleting WORK.METHYL_SBYS2 (memtype=DATA).
NOTE: Deleting WORK.METHYL_SBYS2_BRASS_10CGY_1H (memtype=DATA).
NOTE: Deleting WORK.METHYL_SBYS2_BRASS_10CGY_72H (memtype=DATA).
NOTE: Deleting WORK.METHYL_SBYS2_BRASS_1P4CGY_1H (memtype=DATA).
NOTE: Deleting WORK.METHYL_SBYS2_BRASS_1P4CGY_72H (memtype=DATA).
NOTE: Deleting WORK.METHYL_SBYS2_LONG_1P4CGY_72H (memtype=DATA).
NOTE: Deleting WORK.METHYL_SBYS2_STACK (memtype=DATA).
NOTE: Deleting WORK.REGION2KEEP (memtype=DATA).
NOTE: Deleting WORK.SITES_PER_REGION (memtype=DATA).
354        run;

355        quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           15.70 seconds
      cpu time            8.77 seconds
      

356        
357        
358        data all_dac;
359           set wgbslocB.FET_DAC_brass_0cGy_1h_100U_0U (in=in1)
360               wgbslocB.FET_DAC_brass_10cGy_1h_100U_0U (in=in2)
361               wgbslocB.FET_DAC_brass_1p4cGy_1h_100U_0U (in=in3)
362               wgbslocB.FET_DAC_brass_0cGy_72h_100U_0U (in=in4)
363               wgbslocB.FET_DAC_brass_10cGy_72h_100U_0U (in=in5)
364               wgbslocB.FET_DAC_brass_1p4cGy_72h_100U_0U (in=in6)
365               wgbslocB.FET_DAC_long_0cGy_72h_100U_0U (in=in7)
366               wgbslocB.FET_DAC_long_1p4cGy_72h_100U_0U (in=in8);
367           length comparison $32.;
368           if in1 then comparison = "brass_0cGy_1h_100U_0U";
369           if in2 then comparison = "brass_10cGy_1h_100U_0U";
370           if in3 then comparison = "brass_1p4cGy_1h_100U_0U";
371           if in4 then comparison = "brass_0cGy_72h_100U_0U";
16                                                         The SAS System                               13:30 Monday, April 17, 2023

372           if in5 then comparison = "brass_10cGy_72h_100U_0U";
373           if in6 then comparison = "brass_1p4cGy_72h_100U_0U";
374           if in7 then comparison = "long_0cGy_72h_100U_0U";
375           if in8 then comparison = "long_1p4cGy_72h_100U_0U";
376        run;

NOTE: There were 11640033 observations read from the data set WGBSLOCB.FET_DAC_BRASS_0CGY_1H_100U_0U.
NOTE: There were 12616658 observations read from the data set WGBSLOCB.FET_DAC_BRASS_10CGY_1H_100U_0U.
NOTE: There were 12934643 observations read from the data set WGBSLOCB.FET_DAC_BRASS_1P4CGY_1H_100U_0U.
NOTE: There were 10730722 observations read from the data set WGBSLOCB.FET_DAC_BRASS_0CGY_72H_100U_0U.
NOTE: There were 12996920 observations read from the data set WGBSLOCB.FET_DAC_BRASS_10CGY_72H_100U_0U.
NOTE: There were 13913408 observations read from the data set WGBSLOCB.FET_DAC_BRASS_1P4CGY_72H_100U_0U.
NOTE: There were 14428260 observations read from the data set WGBSLOCB.FET_DAC_LONG_0CGY_72H_100U_0U.
NOTE: There were 14136512 observations read from the data set WGBSLOCB.FET_DAC_LONG_1P4CGY_72H_100U_0U.
NOTE: The data set WORK.ALL_DAC has 103397156 observations and 25 variables.
NOTE: DATA statement used (Total process time):
      real time           42.15 seconds
      cpu time            40.29 seconds
      

377        
378        proc sort data=all_dac nodup;
379           by comparison site_type  chr start_pos stop_pos ;
380        run;

NOTE: There were 103397156 observations read from the data set WORK.ALL_DAC.
NOTE: 0 duplicate observations were deleted.
NOTE: The data set WORK.ALL_DAC has 103397156 observations and 25 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           2:27.34
      cpu time            2:19.30
      

381        
382        
383        /* Need to get methylation rates and calculate differences */
384        
385        data methyl_data;
386            set wgbslocB.methylation_data_gc (in=in1)
387                wgbslocL.methylation_data_gc (in=in2);
NOTE: Data file WGBSLOCB.METHYLATION_DATA_GC.DATA is in a format that is native to another host, or the file encoding does not 
      match the session encoding. Cross Environment Data Access will be used, which might require additional CPU resources and 
      might reduce performance.
388            length project $12.;
389            if chr="Mt" or chr="Pt" then delete;
390            if in1 then project = "brass";
391            if in2 then project = "long";
392            if in2 then time = "72h";
393            if treatment="1_4cGy"  then treatment="1p4cGy";
394            if flag_normalized=1 then perc_methyl2=perc_methyl_norm;
395            else if flag_normalized=. then perc_methyl2=perc_methyl;
396            else delete;
397        run;

NOTE: There were 426950832 observations read from the data set WGBSLOCB.METHYLATION_DATA_GC.
NOTE: There were 141239734 observations read from the data set WGBSLOCL.METHYLATION_DATA_GC.
NOTE: The data set WORK.METHYL_DATA has 498055422 observations and 17 variables.
NOTE: DATA statement used (Total process time):
17                                                         The SAS System                               13:30 Monday, April 17, 2023

      real time           10:54.78
      cpu time            10:53.30
      

398        
399        
400        
401        proc sort data=methyl_data;
402           by chr start_pos stop_pos site_type project treatment time units;
403        run;

NOTE: There were 498055422 observations read from the data set WORK.METHYL_DATA.
NOTE: The data set WORK.METHYL_DATA has 498055422 observations and 17 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           15:11.93
      cpu time            15:01.56
      

404        
405        proc means data=methyl_data noprint;
406           by chr start_pos stop_pos site_type project treatment time units;
407           var total_C perc_methyl_norm;
408           output out=methyl_perc sum(total_C)=total_C mean(perc_methyl2)=perc_methyl;
409        run;

NOTE: There were 498055422 observations read from the data set WORK.METHYL_DATA.
NOTE: The data set WORK.METHYL_PERC has 251080083 observations and 12 variables.
NOTE: PROCEDURE MEANS used (Total process time):
      real time           5:28.24
      cpu time            5:22.64
      

410        
411        /* remove sites without at least 10 reasd in wither 100U or 0U
412            then BEFORE FDR, I want to remove sites that I can't use for pairwise comparisons
413            (e.g. for 0Gy vs 0.1Gy, only if in both, 1Gy status irrelevant)
414        
415            So, the ones I'd KEEP for 0.1Gy have to appear in 0.1Gy and 0Gy
416                                  for 1Gy have to appear in 1Gy and 0Gy
417                                  for 0Gy has to appear in EITHER [0.1Gy and 0Gy] OR [1Gy and 0Gy]
418        */
419        
420        data methyl_perc2;
421          set methyl_perc;
422          if total_C < 10 then delete;
423        run;

NOTE: There were 251080083 observations read from the data set WORK.METHYL_PERC.
NOTE: The data set WORK.METHYL_PERC2 has 238349673 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           1:02.81
      cpu time            51.95 seconds
      

424        
425        proc sort data=methyl_perc2;
426           by project time site_type chr start_pos stop_pos treatment units;

18                                                         The SAS System                               13:30 Monday, April 17, 2023

NOTE: There were 238349673 observations read from the data set WORK.METHYL_PERC2.
NOTE: The data set WORK.METHYL_PERC2 has 238349673 observations and 12 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           3:44.59
      cpu time            3:33.37
      

427        proc transpose data=methyl_perc2 out=methyl_sbys;
428          by project time site_type chr start_pos stop_pos;
429          id treatment units;
430          var perc_methyl;
431        run;

NOTE: There were 238349673 observations read from the data set WORK.METHYL_PERC2.
NOTE: The data set WORK.METHYL_SBYS has 48191999 observations and 13 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           12:59.79
      cpu time            12:55.18
      

432        
433        data methyl_sbys2;
434          set methyl_sbys;
435          if _0cGy0U = . or _0cGy100U = . then flag_missing_0cGy=1; else flag_missing_0cGy=0;
436          if _10cGy0U = . or _10cGy100U = . then flag_missing_10cGy=1; else flag_missing_10cGy=0;
437          if _1p4cGy0U = . or _1p4cGy100U = . then flag_missing_1p4cGy=1; else flag_missing_1p4cGy=0;
438        
439          if _0cGy0U = 0 and _0cGy100U = 0 then flag_nometh_0cGy=1; else flag_nometh_0cGy=0;
440          if _10cGy0U = 0 and _10cGy100U = 0 then flag_nometh_10cGy=1; else flag_nometh_10cGy=0;
441          if _1p4cGy0U = 0 and _1p4cGy100U = 0 then flag_nometh_1p4cGy=1; else flag_nometh_1p4cGy=0;
442        
443        
444          drop _NAME_;
445          rename _0cGy0U=methyl_0cGy_0U
446                 _10cGy0U=methyl_10cGy_0U
447                 _1p4cGy0U=methyl_1p4cGy_0U
448                 _0cGy100U=methyl_0cGy_100U
449                 _10cGy100U=methyl_10cGy_100U
450                 _1p4cGy100U=methyl_1p4cGy_100U;
451        run;

NOTE: There were 48191999 observations read from the data set WORK.METHYL_SBYS.
NOTE: The data set WORK.METHYL_SBYS2 has 48191999 observations and 18 variables.
NOTE: DATA statement used (Total process time):
      real time           12.22 seconds
      cpu time            12.16 seconds
      

452        
453        
454        data methyl_sbys_brass_0cGy_1h;
455           set methyl_sbys2;
456           length comparison $32.;
457           if project = "brass" and time = "1h";
458           comparison ="brass_0cGy_1h_100U_0U" ;
459           if flag_missing_0cGy=0 and (flag_missing_10cGy=0 or flag_missing_1p4cGy=0) and flag_nometh_0cGy=0;
460           keep  site_type chr start_pos stop_pos comparison;
461        run;
19                                                         The SAS System                               13:30 Monday, April 17, 2023


NOTE: There were 48191999 observations read from the data set WORK.METHYL_SBYS2.
NOTE: The data set WORK.METHYL_SBYS_BRASS_0CGY_1H has 11714917 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           4.74 seconds
      cpu time            4.53 seconds
      

462        
463        data methyl_sbys_brass_10cGy_1h;
464           set methyl_sbys2;
465           length comparison $32.;
466           if project = "brass" and time = "1h";
467           comparison ="brass_10cGy_1h_100U_0U" ;
468           if flag_missing_0cGy=0 and flag_missing_10cGy=0 and flag_nometh_10cGy=0;
469           keep  site_type chr start_pos stop_pos comparison;
470        run;

NOTE: There were 48191999 observations read from the data set WORK.METHYL_SBYS2.
NOTE: The data set WORK.METHYL_SBYS_BRASS_10CGY_1H has 12349308 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           5.14 seconds
      cpu time            4.42 seconds
      

471        
472        data methyl_sbys_brass_1p4cGy_1h;
473           set methyl_sbys2;
474           length comparison $32.;
475           if project = "brass" and time = "1h";
476           comparison ="brass_1p4cGy_1h_100U_0U" ;
477           if flag_missing_0cGy=0 and flag_missing_1p4cGy=0 and flag_nometh_1p4cGy=0;
478           keep  site_type chr start_pos stop_pos comparison;
479        run;

NOTE: There were 48191999 observations read from the data set WORK.METHYL_SBYS2.
NOTE: The data set WORK.METHYL_SBYS_BRASS_1P4CGY_1H has 11981543 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           4.50 seconds
      cpu time            4.35 seconds
      

480        
481        
482        
483        
484        data methyl_sbys_brass_0cGy_72h;
485           set methyl_sbys2;
486           length comparison $32.;
487           if project = "brass" and time = "72h";
488           comparison ="brass_0cGy_72h_100U_0U" ;
489           if flag_missing_0cGy=0 and (flag_missing_10cGy=0 or flag_missing_1p4cGy=0) and flag_nometh_0cGy=0;
490           keep site_type chr start_pos stop_pos comparison;
491        run;

NOTE: There were 48191999 observations read from the data set WORK.METHYL_SBYS2.
NOTE: The data set WORK.METHYL_SBYS_BRASS_0CGY_72H has 10817127 observations and 5 variables.
NOTE: DATA statement used (Total process time):
20                                                         The SAS System                               13:30 Monday, April 17, 2023

      real time           4.74 seconds
      cpu time            4.14 seconds
      

492        
493        data methyl_sbys_brass_10cGy_72h;
494           set methyl_sbys2;
495           length comparison $32.;
496           if project = "brass" and time = "72h";
497           comparison ="brass_10cGy_72h_100U_0U" ;
498           if flag_missing_0cGy=0 and flag_missing_10cGy=0 and flag_nometh_10cGy=0;
499           keep site_type chr start_pos stop_pos comparison;
500        run;

NOTE: There were 48191999 observations read from the data set WORK.METHYL_SBYS2.
NOTE: The data set WORK.METHYL_SBYS_BRASS_10CGY_72H has 11923750 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           4.33 seconds
      cpu time            4.27 seconds
      

501        
502        data methyl_sbys_brass_1p4cGy_72h;
503           set methyl_sbys2;
504           length comparison $32.;
505           if project = "brass" and time = "72h";
506           comparison ="brass_1p4cGy_72h_100U_0U" ;
507           if flag_missing_0cGy=0 and flag_missing_1p4cGy=0 and flag_nometh_1p4cGy=0;
508           keep site_type chr start_pos stop_pos comparison;
509        run;

NOTE: There were 48191999 observations read from the data set WORK.METHYL_SBYS2.
NOTE: The data set WORK.METHYL_SBYS_BRASS_1P4CGY_72H has 11885565 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           4.58 seconds
      cpu time            4.23 seconds
      

510        
511        
512        data methyl_sbys_long_0cGy_72h;
513           set methyl_sbys2;
514           length comparison $32.;
515           if project = "long" and time = "72h";
516           comparison ="long_0cGy_72h_100U_0U" ;
517           if flag_missing_0cGy=0 and  flag_missing_1p4cGy=0 and flag_nometh_0cGy=0;
518           keep site_type chr start_pos stop_pos comparison;
519        run;

NOTE: There were 48191999 observations read from the data set WORK.METHYL_SBYS2.
NOTE: The data set WORK.METHYL_SBYS_LONG_0CGY_72H has 13741726 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           4.63 seconds
      cpu time            4.25 seconds
      

520        
521        data methyl_sbys_long_1p4cGy_72h;
21                                                         The SAS System                               13:30 Monday, April 17, 2023

522           set methyl_sbys2;
523           length comparison $32.;
524           if project = "long" and time = "72h";
525           comparison ="long_1p4cGy_72h_100U_0U" ;
526           if flag_missing_0cGy=0 and flag_missing_1p4cGy=0 and flag_nometh_1p4cGy=0;
527           keep site_type chr start_pos stop_pos comparison;
528        run;

NOTE: There were 48191999 observations read from the data set WORK.METHYL_SBYS2.
NOTE: The data set WORK.METHYL_SBYS_LONG_1P4CGY_72H has 13759391 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           4.31 seconds
      cpu time            4.18 seconds
      

529        
530        
531        data methyl2keep;
532          set methyl_sbys_brass_0cGy_1h methyl_sbys_brass_10cGy_1h methyl_sbys_brass_1p4cGy_1h
533              methyl_sbys_brass_0cGy_72h methyl_sbys_brass_10cGy_72h methyl_sbys_brass_1p4cGy_72h
534              methyl_sbys_long_0cGy_72h methyl_sbys_long_1p4cGy_72h;
535        run;

NOTE: There were 11714917 observations read from the data set WORK.METHYL_SBYS_BRASS_0CGY_1H.
NOTE: There were 12349308 observations read from the data set WORK.METHYL_SBYS_BRASS_10CGY_1H.
NOTE: There were 11981543 observations read from the data set WORK.METHYL_SBYS_BRASS_1P4CGY_1H.
NOTE: There were 10817127 observations read from the data set WORK.METHYL_SBYS_BRASS_0CGY_72H.
NOTE: There were 11923750 observations read from the data set WORK.METHYL_SBYS_BRASS_10CGY_72H.
NOTE: There were 11885565 observations read from the data set WORK.METHYL_SBYS_BRASS_1P4CGY_72H.
NOTE: There were 13741726 observations read from the data set WORK.METHYL_SBYS_LONG_0CGY_72H.
NOTE: There were 13759391 observations read from the data set WORK.METHYL_SBYS_LONG_1P4CGY_72H.
NOTE: The data set WORK.METHYL2KEEP has 98173327 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           11.85 seconds
      cpu time            11.82 seconds
      

536        
537        
538        proc sort data=methyl2keep;
539           by comparison site_type chr start_pos stop_pos;

NOTE: There were 98173327 observations read from the data set WORK.METHYL2KEEP.
NOTE: The data set WORK.METHYL2KEEP has 98173327 observations and 5 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           59.41 seconds
      cpu time            59.17 seconds
      

540        proc sort data=all_dac;
541           by comparison site_type chr start_pos stop_pos;
542        run;

NOTE: Input data set is already sorted, no sorting done.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.11 seconds
      cpu time            0.00 seconds
      
22                                                         The SAS System                               13:30 Monday, April 17, 2023


543        
544        data all_dac2;
545            merge all_dac (in=in1) methyl2keep (in=in2);
546            by comparison site_type chr start_pos stop_pos;
547            if in1 and in2;
548        run;

NOTE: There were 103397156 observations read from the data set WORK.ALL_DAC.
NOTE: There were 98173327 observations read from the data set WORK.METHYL2KEEP.
NOTE: The data set WORK.ALL_DAC2 has 97251805 observations and 25 variables.
NOTE: DATA statement used (Total process time):
      real time           1:29.09
      cpu time            1:16.05
      

549        
550        
551        proc multtest inpvalues(XP2_FISH)=all_dac2 fdr noprint out=all_dac_fdr;
552        by  comparison site_type;
553        run;

NOTE: There were 97251805 observations read from the data set WORK.ALL_DAC2.
NOTE: The data set WORK.ALL_DAC_FDR has 97251805 observations and 26 variables.
NOTE: PROCEDURE MULTTEST used (Total process time):
      real time           1:27.40
      cpu time            1:19.82
      

554        
555        data all_dac_fdr2;
556          set all_dac_fdr;
557          rename XP2_FISH=FET_P fdr_p=FET_FDR_P;
558        run;

NOTE: There were 97251805 observations read from the data set WORK.ALL_DAC_FDR.
NOTE: The data set WORK.ALL_DAC_FDR2 has 97251805 observations and 26 variables.
NOTE: DATA statement used (Total process time):
      real time           46.04 seconds
      cpu time            41.27 seconds
      

559        
560        proc sort data=all_dac_fdr2;
561           by site_type chr start_pos stop_pos comparison;
562        run;

NOTE: There were 97251805 observations read from the data set WORK.ALL_DAC_FDR2.
NOTE: The data set WORK.ALL_DAC_FDR2 has 97251805 observations and 26 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           3:13.14
      cpu time            3:09.19
      

563        
564        proc transpose data=all_dac_fdr2 out=all_dac_p_sbys;
565           by site_type chr start_pos stop_pos;
566           id comparison;
23                                                         The SAS System                               13:30 Monday, April 17, 2023

567           var FET_P;
568        run;

NOTE: There were 97251805 observations read from the data set WORK.ALL_DAC_FDR2.
NOTE: The data set WORK.ALL_DAC_P_SBYS has 15198679 observations and 14 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           6:37.16
      cpu time            6:32.78
      

569        
570        proc transpose data=all_dac_fdr2 out=all_dac_fdr_sbys;
571           by site_type chr start_pos stop_pos;
572           id comparison;
573           var FET_FDR_P;
574        run;

NOTE: There were 97251805 observations read from the data set WORK.ALL_DAC_FDR2.
NOTE: The data set WORK.ALL_DAC_FDR_SBYS has 15198679 observations and 14 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           6:56.98
      cpu time            6:52.73
      

575        
576        data all_dac_p_sbys2;
577           set all_dac_p_sbys;
578           rename brass_0cGy_1h_100U_0U=FET_P_brass_0cGy_1h_100U_0U
579                  brass_10cGy_1h_100U_0U=FET_P_brass_10cGy_1h_100U_0U
580                  brass_1p4cGy_1h_100U_0U=FET_P_brass_1p4cGy_1h_100U_0U
581                  brass_0cGy_72h_100U_0U=FET_P_brass_0cGy_72h_100U_0U
582                  brass_10cGy_72h_100U_0U=FET_P_brass_10cGy_72h_100U_0U
583                  brass_1p4cGy_72h_100U_0U=FET_P_brass_1p4cGy_72h_100U_0U
584                  long_0cGy_72h_100U_0U=FET_P_long_0cGy_72h_100U_0U
585                  long_1p4cGy_72h_100U_0U=FET_P_long_1p4cGy_72h_100U_0U;
586           drop _NAME_ _LABEL_;
587        run;

NOTE: There were 15198679 observations read from the data set WORK.ALL_DAC_P_SBYS.
NOTE: The data set WORK.ALL_DAC_P_SBYS2 has 15198679 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           3.66 seconds
      cpu time            2.97 seconds
      

588        
589        data all_dac_fdr_sbys2;
590           set all_dac_fdr_sbys;
591           rename brass_0cGy_1h_100U_0U=FET_FDR_brass_0cGy_1h_100U_0U
592                  brass_10cGy_1h_100U_0U=FET_FDR_brass_10cGy_1h_100U_0U
593                  brass_1p4cGy_1h_100U_0U=FET_FDR_brass_1p4cGy_1h_100U_0U
594                  brass_0cGy_72h_100U_0U=FET_FDR_brass_0cGy_72h_100U_0U
595                  brass_10cGy_72h_100U_0U=FET_FDR_brass_10cGy_72h_100U_0U
596                  brass_1p4cGy_72h_100U_0U=FET_FDR_brass_1p4cGy_72h_100U_0U
597                  long_0cGy_72h_100U_0U=FET_FDR_long_0cGy_72h_100U_0U
598                  long_1p4cGy_72h_100U_0U=FET_FDR_long_1p4cGy_72h_100U_0U;
599           drop _NAME_ _LABEL_;
600        run;
24                                                         The SAS System                               13:30 Monday, April 17, 2023


NOTE: There were 15198679 observations read from the data set WORK.ALL_DAC_FDR_SBYS.
NOTE: The data set WORK.ALL_DAC_FDR_SBYS2 has 15198679 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           4.13 seconds
      cpu time            2.90 seconds
      

601        
602        proc sort data=all_dac_p_sbys2;
603          by site_type chr start_pos stop_pos;

NOTE: There were 15198679 observations read from the data set WORK.ALL_DAC_P_SBYS2.
NOTE: The data set WORK.ALL_DAC_P_SBYS2 has 15198679 observations and 12 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           13.46 seconds
      cpu time            10.76 seconds
      

604        proc sort data=all_dac_fdr_sbys2;
605          by site_type chr start_pos stop_pos;
606        run;

NOTE: There were 15198679 observations read from the data set WORK.ALL_DAC_FDR_SBYS2.
NOTE: The data set WORK.ALL_DAC_FDR_SBYS2 has 15198679 observations and 12 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           22.96 seconds
      cpu time            11.22 seconds
      

607        
608        
609        data all_dac_sbys3;
610           merge all_dac_p_sbys2 all_dac_fdr_sbys2;
611          by site_type chr start_pos stop_pos;
612        run;

NOTE: There were 15198679 observations read from the data set WORK.ALL_DAC_P_SBYS2.
NOTE: There were 15198679 observations read from the data set WORK.ALL_DAC_FDR_SBYS2.
NOTE: The data set WORK.ALL_DAC_SBYS3 has 15198679 observations and 20 variables.
NOTE: DATA statement used (Total process time):
      real time           8.79 seconds
      cpu time            7.96 seconds
      

613        
614        
615        
616        
617        
618        
619        
620        /* Need to make a big table of the following:
621           site type, chr, start, stop, methyl_TRT_0U methyl_TRT_100U
622           methyl_CTL_0U methyl_CTL_100U comparison P/FDR for CTL TRT
623           methyl_diff_TRT methyl_diff_CTL methyl_diff_TRT_CTL
624           flag_meth_diff flag_meth_diff_20perc */
625        
25                                                         The SAS System                               13:30 Monday, April 17, 2023

626        
627        
628        
629        data methyl_brass_10cGy_0cGy_1h;
630           set methyl_sbys2;
631           if project = "brass" and time = "1h";
632           keep site_type chr start_pos stop_pos methyl_10cGy_0U methyl_10cGy_100U methyl_0cGy_0U methyl_0cGy_100U;
633           rename methyl_10cGy_0U=methyl_TRT_0U
634                  methyl_10cGy_100U=methyl_TRT_100U
635                  methyl_0cGy_0U=methyl_CTL_0U
636                  methyl_0cGy_100U=methyl_CTL_100U;
637        run;

NOTE: There were 48191999 observations read from the data set WORK.METHYL_SBYS2.
NOTE: The data set WORK.METHYL_BRASS_10CGY_0CGY_1H has 16062906 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           7.91 seconds
      cpu time            5.54 seconds
      

638        
639        
640        data methyl_brass_1p4cGy_0cGy_1h;
641           set methyl_sbys2;
642           if project = "brass" and time = "1h";
643           keep site_type chr start_pos stop_pos methyl_1p4cGy_0U methyl_1p4cGy_100U methyl_0cGy_0U methyl_0cGy_100U;
644           rename methyl_1p4cGy_0U=methyl_TRT_0U
645                  methyl_1p4cGy_100U=methyl_TRT_100U
646                  methyl_0cGy_0U=methyl_CTL_0U
647                  methyl_0cGy_100U=methyl_CTL_100U;
648        run;

NOTE: There were 48191999 observations read from the data set WORK.METHYL_SBYS2.
NOTE: The data set WORK.METHYL_BRASS_1P4CGY_0CGY_1H has 16062906 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           7.63 seconds
      cpu time            5.84 seconds
      

649        
650        data methyl_brass_10cGy_0cGy_72h;
651           set methyl_sbys2;
652           if project = "brass" and time = "72h";
653           keep site_type chr start_pos stop_pos methyl_10cGy_0U methyl_10cGy_100U methyl_0cGy_0U methyl_0cGy_100U;
654           rename methyl_10cGy_0U=methyl_TRT_0U
655                  methyl_10cGy_100U=methyl_TRT_100U
656                  methyl_0cGy_0U=methyl_CTL_0U
657                  methyl_0cGy_100U=methyl_CTL_100U;
658        run;

NOTE: There were 48191999 observations read from the data set WORK.METHYL_SBYS2.
NOTE: The data set WORK.METHYL_BRASS_10CGY_0CGY_72H has 16156358 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           5.18 seconds
      cpu time            4.91 seconds
      

659        
26                                                         The SAS System                               13:30 Monday, April 17, 2023

660        
661        data methyl_brass_1p4cGy_0cGy_72h;
662           set methyl_sbys2;
663           if project = "brass" and time = "72h";
664           keep site_type chr start_pos stop_pos methyl_1p4cGy_0U methyl_1p4cGy_100U methyl_0cGy_0U methyl_0cGy_100U;
665           rename methyl_1p4cGy_0U=methyl_TRT_0U
666                  methyl_1p4cGy_100U=methyl_TRT_100U
667                  methyl_0cGy_0U=methyl_CTL_0U
668                  methyl_0cGy_100U=methyl_CTL_100U;
669        run;

NOTE: There were 48191999 observations read from the data set WORK.METHYL_SBYS2.
NOTE: The data set WORK.METHYL_BRASS_1P4CGY_0CGY_72H has 16156358 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           6.94 seconds
      cpu time            4.87 seconds
      

670        
671        data methyl_long_1p4cGy_0cGy_72h;
672           set methyl_sbys2;
673           if project = "long" and time = "72h";
674           keep site_type chr start_pos stop_pos methyl_1p4cGy_0U methyl_1p4cGy_100U methyl_0cGy_0U methyl_0cGy_100U;
675           rename methyl_1p4cGy_0U=methyl_TRT_0U
676                  methyl_1p4cGy_100U=methyl_TRT_100U
677                  methyl_0cGy_0U=methyl_CTL_0U
678                  methyl_0cGy_100U=methyl_CTL_100U;
679        run;

NOTE: There were 48191999 observations read from the data set WORK.METHYL_SBYS2.
NOTE: The data set WORK.METHYL_LONG_1P4CGY_0CGY_72H has 15972735 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           6.93 seconds
      cpu time            4.61 seconds
      

680        
681        data dac_brass_10cGy_0cGy_1h;
682          set all_dac_sbys3;
683          if FET_P_brass_10cGy_1h_100U_0U=. or FET_P_brass_0cGy_1h_100U_0U=. then delete;
684          keep site_Type chr start_pos stop_pos
685               FET_P_brass_10cGy_1h_100U_0U FET_P_brass_0cGy_1h_100U_0U
686               FET_FDR_brass_10cGy_1h_100U_0U FET_FDR_brass_0cGy_1h_100U_0U;
687           rename FET_P_brass_10cGy_1h_100U_0U=FET_P_TRT_100U_0U
688                  FET_P_brass_0cGy_1h_100U_0U =FET_P_CTL_100U_0U
689                  FET_FDR_brass_10cGy_1h_100U_0U=FET_FDR_P_TRT_100U_0U
690                  FET_FDR_brass_0cGy_1h_100U_0U=FET_FDR_P_CTL_100U_0U;
691        run;

NOTE: There were 15198679 observations read from the data set WORK.ALL_DAC_SBYS3.
NOTE: The data set WORK.DAC_BRASS_10CGY_0CGY_1H has 10571537 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           5.47 seconds
      cpu time            2.24 seconds
      

692        
693        
27                                                         The SAS System                               13:30 Monday, April 17, 2023

694        data dac_brass_1p4cGy_0cGy_1h;
695          set all_dac_sbys3;
696          if FET_P_brass_1p4cGy_1h_100U_0U=. or FET_P_brass_0cGy_1h_100U_0U=. then delete;
697          keep site_Type chr start_pos stop_pos
698               FET_P_brass_1p4cGy_1h_100U_0U FET_P_brass_0cGy_1h_100U_0U
699               FET_FDR_brass_1p4cGy_1h_100U_0U FET_FDR_brass_0cGy_1h_100U_0U;
700           rename FET_P_brass_1p4cGy_1h_100U_0U=FET_P_TRT_100U_0U
701                  FET_P_brass_0cGy_1h_100U_0U =FET_P_CTL_100U_0U
702                  FET_FDR_brass_1p4cGy_1h_100U_0U=FET_FDR_P_TRT_100U_0U
703                  FET_FDR_brass_0cGy_1h_100U_0U=FET_FDR_P_CTL_100U_0U;
704        run;

NOTE: There were 15198679 observations read from the data set WORK.ALL_DAC_SBYS3.
NOTE: The data set WORK.DAC_BRASS_1P4CGY_0CGY_1H has 10284451 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           9.13 seconds
      cpu time            2.04 seconds
      

705        
706        data dac_brass_10cGy_0cGy_72h;
707          set all_dac_sbys3;
708          if FET_P_brass_10cGy_72h_100U_0U=. or FET_P_brass_0cGy_72h_100U_0U=. then delete;
709          keep site_Type chr start_pos stop_pos
710               FET_P_brass_10cGy_72h_100U_0U FET_P_brass_0cGy_72h_100U_0U
711               FET_FDR_brass_10cGy_72h_100U_0U FET_FDR_brass_0cGy_72h_100U_0U;
712           rename FET_P_brass_10cGy_72h_100U_0U=FET_P_TRT_100U_0U
713                  FET_P_brass_0cGy_72h_100U_0U =FET_P_CTL_100U_0U
714                  FET_FDR_brass_10cGy_72h_100U_0U=FET_FDR_P_TRT_100U_0U
715                  FET_FDR_brass_0cGy_72h_100U_0U=FET_FDR_P_CTL_100U_0U;
716        run;

NOTE: There were 15198679 observations read from the data set WORK.ALL_DAC_SBYS3.
NOTE: The data set WORK.DAC_BRASS_10CGY_0CGY_72H has 10158043 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           5.15 seconds
      cpu time            1.98 seconds
      

717        
718        
719        data dac_brass_1p4cGy_0cGy_72h;
720          set all_dac_sbys3;
721          if FET_P_brass_1p4cGy_72h_100U_0U=. or FET_P_brass_0cGy_72h_100U_0U=. then delete;
722          keep site_Type chr start_pos stop_pos
723               FET_P_brass_1p4cGy_72h_100U_0U FET_P_brass_0cGy_72h_100U_0U
724               FET_FDR_brass_1p4cGy_72h_100U_0U FET_FDR_brass_0cGy_72h_100U_0U;
725           rename FET_P_brass_1p4cGy_72h_100U_0U=FET_P_TRT_100U_0U
726                  FET_P_brass_0cGy_72h_100U_0U =FET_P_CTL_100U_0U
727                  FET_FDR_brass_1p4cGy_72h_100U_0U=FET_FDR_P_TRT_100U_0U
728                  FET_FDR_brass_0cGy_72h_100U_0U=FET_FDR_P_CTL_100U_0U;
729        run;

NOTE: There were 15198679 observations read from the data set WORK.ALL_DAC_SBYS3.
NOTE: The data set WORK.DAC_BRASS_1P4CGY_0CGY_72H has 10098148 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           9.44 seconds
      cpu time            2.03 seconds
28                                                         The SAS System                               13:30 Monday, April 17, 2023

      

730        
731        
732        data dac_long_1p4cGy_0cGy_72h;
733          set all_dac_sbys3;
734          if FET_P_long_1p4cGy_72h_100U_0U=. or FET_P_long_0cGy_72h_100U_0U=. then delete;
735          keep site_Type chr start_pos stop_pos
736               FET_P_long_1p4cGy_72h_100U_0U FET_P_long_0cGy_72h_100U_0U
737               FET_FDR_long_1p4cGy_72h_100U_0U FET_FDR_long_0cGy_72h_100U_0U;
738           rename FET_P_long_1p4cGy_72h_100U_0U=FET_P_TRT_100U_0U
739                  FET_P_long_0cGy_72h_100U_0U =FET_P_CTL_100U_0U
740                  FET_FDR_long_1p4cGy_72h_100U_0U=FET_FDR_P_TRT_100U_0U
741                  FET_FDR_long_0cGy_72h_100U_0U=FET_FDR_P_CTL_100U_0U;
742        run;

NOTE: There were 15198679 observations read from the data set WORK.ALL_DAC_SBYS3.
NOTE: The data set WORK.DAC_LONG_1P4CGY_0CGY_72H has 13597159 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           4.06 seconds
      cpu time            2.27 seconds
      

743        
744        
745        
746        proc sort data=methyl_brass_10cGy_0cGy_1h;
747           by site_type chr start_pos stop_pos;

NOTE: There were 16062906 observations read from the data set WORK.METHYL_BRASS_10CGY_0CGY_1H.
NOTE: The data set WORK.METHYL_BRASS_10CGY_0CGY_1H has 16062906 observations and 8 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           17.32 seconds
      cpu time            10.88 seconds
      

748        proc sort data=dac_brass_10cGy_0cGy_1h;
749           by site_type chr start_pos stop_pos;

NOTE: There were 10571537 observations read from the data set WORK.DAC_BRASS_10CGY_0CGY_1H.
NOTE: The data set WORK.DAC_BRASS_10CGY_0CGY_1H has 10571537 observations and 8 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           9.71 seconds
      cpu time            6.69 seconds
      

750        proc sort data=methyl_brass_1p4cGy_0cGy_1h;
751           by site_type chr start_pos stop_pos;

NOTE: There were 16062906 observations read from the data set WORK.METHYL_BRASS_1P4CGY_0CGY_1H.
NOTE: The data set WORK.METHYL_BRASS_1P4CGY_0CGY_1H has 16062906 observations and 8 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           10.55 seconds
      cpu time            10.07 seconds
      

752        proc sort data=dac_brass_1p4cGy_0cGy_1h;
753           by site_type chr start_pos stop_pos;
29                                                         The SAS System                               13:30 Monday, April 17, 2023


NOTE: There were 10284451 observations read from the data set WORK.DAC_BRASS_1P4CGY_0CGY_1H.
NOTE: The data set WORK.DAC_BRASS_1P4CGY_0CGY_1H has 10284451 observations and 8 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           7.99 seconds
      cpu time            6.46 seconds
      

754        proc sort data=methyl_brass_10cGy_0cGy_72h;
755           by site_type chr start_pos stop_pos;

NOTE: There were 16156358 observations read from the data set WORK.METHYL_BRASS_10CGY_0CGY_72H.
NOTE: The data set WORK.METHYL_BRASS_10CGY_0CGY_72H has 16156358 observations and 8 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           16.08 seconds
      cpu time            9.75 seconds
      

756        proc sort data=dac_brass_10cGy_0cGy_72h;
757           by site_type chr start_pos stop_pos;

NOTE: There were 10158043 observations read from the data set WORK.DAC_BRASS_10CGY_0CGY_72H.
NOTE: The data set WORK.DAC_BRASS_10CGY_0CGY_72H has 10158043 observations and 8 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           28.69 seconds
      cpu time            6.99 seconds
      

758        proc sort data=methyl_brass_1p4cGy_0cGy_72h;
759           by site_type chr start_pos stop_pos;

NOTE: There were 16156358 observations read from the data set WORK.METHYL_BRASS_1P4CGY_0CGY_72H.
NOTE: The data set WORK.METHYL_BRASS_1P4CGY_0CGY_72H has 16156358 observations and 8 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           16.96 seconds
      cpu time            9.91 seconds
      

760        proc sort data=dac_brass_1p4cGy_0cGy_72h;
761           by site_type chr start_pos stop_pos;

NOTE: There were 10098148 observations read from the data set WORK.DAC_BRASS_1P4CGY_0CGY_72H.
NOTE: The data set WORK.DAC_BRASS_1P4CGY_0CGY_72H has 10098148 observations and 8 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           10.94 seconds
      cpu time            6.37 seconds
      

762        proc sort data=methyl_long_1p4cGy_0cGy_72h;
763           by site_type chr start_pos stop_pos;

NOTE: There were 15972735 observations read from the data set WORK.METHYL_LONG_1P4CGY_0CGY_72H.
NOTE: The data set WORK.METHYL_LONG_1P4CGY_0CGY_72H has 15972735 observations and 8 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           11.63 seconds
      cpu time            9.68 seconds
      

30                                                         The SAS System                               13:30 Monday, April 17, 2023

764        proc sort data=dac_long_1p4cGy_0cGy_72h;
765           by site_type chr start_pos stop_pos;
766        run;

NOTE: There were 13597159 observations read from the data set WORK.DAC_LONG_1P4CGY_0CGY_72H.
NOTE: The data set WORK.DAC_LONG_1P4CGY_0CGY_72H has 13597159 observations and 8 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           14.00 seconds
      cpu time            8.39 seconds
      

767        
768        data dac_meth_brass_10cGy_0cGy_1h;
769          merge dac_brass_10cGy_0cGy_1h (in=in1) methyl_brass_10cGy_0cGy_1h (in=in2);
770          by site_type chr start_pos stop_pos;
771          if in1 and in2;
772        run;

NOTE: There were 10571537 observations read from the data set WORK.DAC_BRASS_10CGY_0CGY_1H.
NOTE: There were 16062906 observations read from the data set WORK.METHYL_BRASS_10CGY_0CGY_1H.
NOTE: The data set WORK.DAC_METH_BRASS_10CGY_0CGY_1H has 10571537 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           7.01 seconds
      cpu time            6.47 seconds
      

773        
774        data dac_meth_brass_1p4cGy_0cGy_1h;
775          merge dac_brass_1p4cGy_0cGy_1h (in=in1) methyl_brass_1p4cGy_0cGy_1h (in=in2);
776          by site_type chr start_pos stop_pos;
777          if in1 and in2;
778        run;

NOTE: There were 10284451 observations read from the data set WORK.DAC_BRASS_1P4CGY_0CGY_1H.
NOTE: There were 16062906 observations read from the data set WORK.METHYL_BRASS_1P4CGY_0CGY_1H.
NOTE: The data set WORK.DAC_METH_BRASS_1P4CGY_0CGY_1H has 10284451 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           6.97 seconds
      cpu time            6.26 seconds
      

779        
780        data dac_meth_brass_10cGy_0cGy_72h;
781          merge dac_brass_10cGy_0cGy_72h (in=in1) methyl_brass_10cGy_0cGy_72h (in=in2);
782          by site_type chr start_pos stop_pos;
783          if in1 and in2;
784        run;

NOTE: There were 10158043 observations read from the data set WORK.DAC_BRASS_10CGY_0CGY_72H.
NOTE: There were 16156358 observations read from the data set WORK.METHYL_BRASS_10CGY_0CGY_72H.
NOTE: The data set WORK.DAC_METH_BRASS_10CGY_0CGY_72H has 10158043 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           7.04 seconds
      cpu time            6.35 seconds
      

785        
786        data dac_meth_brass_1p4cGy_0cGy_72h;
31                                                         The SAS System                               13:30 Monday, April 17, 2023

787          merge dac_brass_1p4cGy_0cGy_72h (in=in1) methyl_brass_1p4cGy_0cGy_72h (in=in2);
788          by site_type chr start_pos stop_pos;
789          if in1 and in2;
790        run;

NOTE: There were 10098148 observations read from the data set WORK.DAC_BRASS_1P4CGY_0CGY_72H.
NOTE: There were 16156358 observations read from the data set WORK.METHYL_BRASS_1P4CGY_0CGY_72H.
NOTE: The data set WORK.DAC_METH_BRASS_1P4CGY_0CGY_72H has 10098148 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           6.40 seconds
      cpu time            6.38 seconds
      

791        
792        
793        data dac_meth_long_1p4cGy_0cGy_72h;
794          merge dac_long_1p4cGy_0cGy_72h (in=in1) methyl_long_1p4cGy_0cGy_72h (in=in2);
795          by site_type chr start_pos stop_pos;
796          if in1 and in2;
797        run;

NOTE: There were 13597159 observations read from the data set WORK.DAC_LONG_1P4CGY_0CGY_72H.
NOTE: There were 15972735 observations read from the data set WORK.METHYL_LONG_1P4CGY_0CGY_72H.
NOTE: The data set WORK.DAC_METH_LONG_1P4CGY_0CGY_72H has 13597159 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           6.81 seconds
      cpu time            6.66 seconds
      

798        
799        
800        
801        
802        data dac_meth_all;
803           set dac_meth_brass_10cGy_0cGy_1h (in=in1)
804               dac_meth_brass_1p4cGy_0cGy_1h (in=in2)
805               dac_meth_brass_10cGy_0cGy_72h (in=in3)
806               dac_meth_brass_1p4cGy_0cGy_72h (in=in4)
807               dac_meth_long_1p4cGy_0cGy_72h (in=in5);
808           length comparison $32.;
809           if in1 then comparison="brass_10cGy_0cGy_1h";
810           if in2 then comparison="brass_1p4cGy_0cGy_1h";
811           if in3 then comparison="brass_10cGy_0cGy_72h";
812           if in4 then comparison="brass_1p4cGy_0cGy_72h";
813           if in5 then comparison="long_1p4cGy_0cGy_72h";
814        run;

NOTE: There were 10571537 observations read from the data set WORK.DAC_METH_BRASS_10CGY_0CGY_1H.
NOTE: There were 10284451 observations read from the data set WORK.DAC_METH_BRASS_1P4CGY_0CGY_1H.
NOTE: There were 10158043 observations read from the data set WORK.DAC_METH_BRASS_10CGY_0CGY_72H.
NOTE: There were 10098148 observations read from the data set WORK.DAC_METH_BRASS_1P4CGY_0CGY_72H.
NOTE: There were 13597159 observations read from the data set WORK.DAC_METH_LONG_1P4CGY_0CGY_72H.
NOTE: The data set WORK.DAC_METH_ALL has 54709338 observations and 13 variables.
NOTE: DATA statement used (Total process time):
      real time           12.32 seconds
      cpu time            12.16 seconds
      

32                                                         The SAS System                               13:30 Monday, April 17, 2023

815        
816        data dac_meth_all2;
817           set dac_meth_all;
818           methyl_diff_TRT=methyl_TRT_100U-methyl_TRT_0U;
819           methyl_diff_CTL=methyl_CTL_100U-methyl_CTL_0U;
820           methyl_diff_TRT_CTL=methyl_diff_TRT-methyl_diff_CTL;
821           if methyl_diff_TRT_CTL = .  then flag_meth_diff=.;
822           else if methyl_diff_TRT_CTL < 0  then flag_meth_diff=-1;
823           else if methyl_diff_TRT_CTL > 0  then flag_meth_diff=1;
824           else  flag_meth_diff=0;
825           if abs(methyl_diff_TRT_CTL) >= 0.1 then flag_meth_diff_10perc=1;
826           else flag_meth_diff_10perc=0;
827           if abs(methyl_diff_TRT_CTL) >= 0.2 then flag_meth_diff_20perc=1;
828           else flag_meth_diff_20perc=0;
829           if FET_FDR_P_TRT_100U_0U=1 or FET_FDR_P_CTL_100U_0U=1 then flag_FDR05_CTL_or_TRT=1;
830           else flag_FDR05_CTL_or_TRT=0;
831        run;

NOTE: There were 54709338 observations read from the data set WORK.DAC_METH_ALL.
NOTE: The data set WORK.DAC_METH_ALL2 has 54709338 observations and 20 variables.
NOTE: DATA statement used (Total process time):
      real time           51.13 seconds
      cpu time            28.80 seconds
      

832        
833        
834        data wgbslocB.results_by_dac_w_meth_v4;
835          set dac_meth_all2;
836        run;

NOTE: There were 54709338 observations read from the data set WORK.DAC_METH_ALL2.
NOTE: The data set WGBSLOCB.RESULTS_BY_DAC_W_METH_V4 has 54709338 observations and 20 variables.
NOTE: DATA statement used (Total process time):
      real time           20.72 seconds
      cpu time            20.25 seconds
      

837        
838        
839        /* Group DMCs into windows
840         Sites must be no more than 100bp away from the next site
841         Sites must have the same direction to be included
842         Region must have at least 3 sites
843         A DMR has at least 3 DMCs (flag 1 and 3)
844         */
845        
846        data dac;
847        set dac_meth_all2;
848        if flag_meth_diff_10perc = 1 and flag_FDR05_CTL_or_TRT = 1;
849        keep comparison site_type chr start_pos stop_pos flag_meth_diff;
850        run;

NOTE: There were 54709338 observations read from the data set WORK.DAC_METH_ALL2.
NOTE: The data set WORK.DAC has 6864759 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           5.32 seconds
      cpu time            5.22 seconds
33                                                         The SAS System                               13:30 Monday, April 17, 2023

      

851        
852        proc sort data=dac;
853        by comparison site_type chr start_pos stop_pos;
854        run;

NOTE: There were 6864759 observations read from the data set WORK.DAC.
NOTE: The data set WORK.DAC has 6864759 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           4.03 seconds
      cpu time            3.98 seconds
      

855        
856        data group_dac;
857        retain region_num;
858        set dac;
859        by comparison site_type chr;
860           prev_pos=lag1(start_pos);
861           prev_direction=lag1(flag_meth_diff);
862           if first.chr then region_num=1;
863           else do;
864           if prev_pos >= start_pos-100 and prev_direction=flag_meth_diff then region_num=region_num;
865          else region_num=region_num + 1;
866         end;
867        run;

NOTE: There were 6864759 observations read from the data set WORK.DAC.
NOTE: The data set WORK.GROUP_DAC has 6864759 observations and 9 variables.
NOTE: DATA statement used (Total process time):
      real time           2.08 seconds
      cpu time            1.72 seconds
      

868        
869        
870        proc freq data=group_dac noprint;
871        tables comparison*site_type*chr*region_num / out=sites_per_region;
872        run;

NOTE: There were 6864759 observations read from the data set WORK.GROUP_DAC.
NOTE: The data set WORK.SITES_PER_REGION has 4409950 observations and 6 variables.
NOTE: PROCEDURE FREQ used (Total process time):
      real time           28.09 seconds
      cpu time            10.77 seconds
      

873        
874        data flag_region_ge2;
875        set sites_per_region;
876        if count >= 2 then flag_num_sites_ge2=1;
877        else flag_num_sites_ge2=0;
878        if count >= 3 then flag_num_sites_ge3=1;
879        else flag_num_sites_ge3=0;
880        if count >= 5 then flag_num_sites_ge5=1;
881        else flag_num_sites_ge5=0;
882        if count >= 10 then flag_num_sites_ge10=1;
34                                                         The SAS System                               13:30 Monday, April 17, 2023

883        else flag_num_sites_ge10=0;
884        
885        run;

NOTE: There were 4409950 observations read from the data set WORK.SITES_PER_REGION.
NOTE: The data set WORK.FLAG_REGION_GE2 has 4409950 observations and 10 variables.
NOTE: DATA statement used (Total process time):
      real time           2.68 seconds
      cpu time            0.90 seconds
      

886        
887        proc freq data=flag_region_ge2;
888        tables comparison*site_type*flaG_num_sites_ge2 / out=dmr_check1;
889        tables comparison*site_type*flaG_num_sites_ge3 / out=dmr_check2;
890        tables comparison*site_type*flaG_num_sites_ge5 / out=dmr_check3;
891        tables comparison*site_type*flaG_num_sites_ge10 / out=dmr_check4;
892        run;

NOTE: There were 4409950 observations read from the data set WORK.FLAG_REGION_GE2.
NOTE: The data set WORK.DMR_CHECK1 has 10 observations and 5 variables.
NOTE: The data set WORK.DMR_CHECK2 has 10 observations and 5 variables.
NOTE: The data set WORK.DMR_CHECK3 has 10 observations and 5 variables.
NOTE: The data set WORK.DMR_CHECK4 has 10 observations and 5 variables.
NOTE: The PROCEDURE FREQ printed pages 11-17.
NOTE: PROCEDURE FREQ used (Total process time):
      real time           6.90 seconds
      cpu time            2.38 seconds
      

893        
894        proc print data=dmr_check1;

NOTE: There were 10 observations read from the data set WORK.DMR_CHECK1.
NOTE: The PROCEDURE PRINT printed page 18.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           3.08 seconds
      cpu time            0.01 seconds
      

895        proc print data=dmr_check2;

NOTE: There were 10 observations read from the data set WORK.DMR_CHECK2.
NOTE: The PROCEDURE PRINT printed page 19.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

896        proc print data=dmr_check3;

NOTE: There were 10 observations read from the data set WORK.DMR_CHECK3.
NOTE: The PROCEDURE PRINT printed page 20.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

35                                                         The SAS System                               13:30 Monday, April 17, 2023

897        proc print data=dmr_check4;
898        run;

NOTE: There were 10 observations read from the data set WORK.DMR_CHECK4.
NOTE: The PROCEDURE PRINT printed page 21.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           1.53 seconds
      cpu time            0.00 seconds
      

899        
900        
901        proc sort data=group_dac;
902           by comparison site_type chr start_pos stop_pos;

NOTE: There were 6864759 observations read from the data set WORK.GROUP_DAC.
NOTE: The data set WORK.GROUP_DAC has 6864759 observations and 9 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           10.83 seconds
      cpu time            5.89 seconds
      

903        proc sort data=dac_meth_all2;
904           by comparison site_type chr start_pos stop_pos;
905        run;

NOTE: There were 54709338 observations read from the data set WORK.DAC_METH_ALL2.
NOTE: The data set WORK.DAC_METH_ALL2 has 54709338 observations and 20 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           1:11.26
      cpu time            1:07.77
      

906        
907        data group_dac2;
908           merge group_dac (in=in1) dac_meth_all2 (in=in2);
909           by comparison site_type chr start_pos stop_pos;
910           if in1 and in2;
911        run;

NOTE: There were 6864759 observations read from the data set WORK.GROUP_DAC.
NOTE: There were 54709338 observations read from the data set WORK.DAC_METH_ALL2.
NOTE: The data set WORK.GROUP_DAC2 has 6864759 observations and 23 variables.
NOTE: DATA statement used (Total process time):
      real time           28.17 seconds
      cpu time            26.70 seconds
      

912        
913        
914        data region2keep;
915        set flag_region_ge2;
916        where flaG_num_sites_ge5=1;
917        keep comparison site_type chr region_num;
918        run;

NOTE: There were 112621 observations read from the data set WORK.FLAG_REGION_GE2.
      WHERE flaG_num_sites_ge5=1;
36                                                         The SAS System                               13:30 Monday, April 17, 2023

NOTE: The data set WORK.REGION2KEEP has 112621 observations and 4 variables.
NOTE: DATA statement used (Total process time):
      real time           2.70 seconds
      cpu time            0.28 seconds
      

919        
920        proc sort data=region2keep;
921        by comparison site_type chr region_num;

NOTE: There were 112621 observations read from the data set WORK.REGION2KEEP.
NOTE: The data set WORK.REGION2KEEP has 112621 observations and 4 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.08 seconds
      cpu time            0.07 seconds
      

922        proc sort data=group_dac2;
923        by comparison site_type chr region_num;
924        run;

NOTE: There were 6864759 observations read from the data set WORK.GROUP_DAC2.
NOTE: The data set WORK.GROUP_DAC2 has 6864759 observations and 23 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           11.09 seconds
      cpu time            8.54 seconds
      

925        
926        data group_dac3;
927        merge group_dac2 (in=in1) region2keep (in=in2);
928        by comparison site_type chr region_num;
929        if in1 and in2;
930        run;

NOTE: There were 6864759 observations read from the data set WORK.GROUP_DAC2.
NOTE: There were 112621 observations read from the data set WORK.REGION2KEEP.
NOTE: The data set WORK.GROUP_DAC3 has 675590 observations and 23 variables.
NOTE: DATA statement used (Total process time):
      real time           3.97 seconds
      cpu time            2.98 seconds
      

931        
932        
933        /* Make permanent */
934        
935        data wgbslocB.cytosine_to_acc_region_index_v4;
936        set group_dac2;
937        run;

NOTE: There were 6864759 observations read from the data set WORK.GROUP_DAC2.
NOTE: The data set WGBSLOCB.CYTOSINE_TO_ACC_REGION_INDEX_V4 has 6864759 observations and 23 variables.
NOTE: DATA statement used (Total process time):
      real time           3.28 seconds
      cpu time            2.45 seconds
      

37                                                         The SAS System                               13:30 Monday, April 17, 2023

938        
939        data wgbslocB.acc_region_flag_site_ge5_v4;
940        set flag_region_ge2;
941        run;

NOTE: There were 4409950 observations read from the data set WORK.FLAG_REGION_GE2.
NOTE: The data set WGBSLOCB.ACC_REGION_FLAG_SITE_GE5_V4 has 4409950 observations and 10 variables.
NOTE: DATA statement used (Total process time):
      real time           0.86 seconds
      cpu time            0.81 seconds
      

942        
943        
944        data wgbslocB.cytosine_to_acc_region_ge5_v4;
945        set group_dac3;
946        run;

NOTE: There were 675590 observations read from the data set WORK.GROUP_DAC3.
NOTE: The data set WGBSLOCB.CYTOSINE_TO_ACC_REGION_GE5_V4 has 675590 observations and 23 variables.
NOTE: DATA statement used (Total process time):
      real time           0.31 seconds
      cpu time            0.26 seconds
      

947        
948        
949        /* Export BED files for various tools */
950        
951        
952        data methylation_regions;
953           set group_dmc;
ERROR: File WORK.GROUP_DMC.DATA does not exist.
954           length regionID $100.;
955           regionID=catx("|", site_type, chr, region_num);
956           keep chr start_pos stop_pos regionID;
957        run;

WARNING: The variable start_pos in the DROP, KEEP, or RENAME list has never been referenced.
WARNING: The variable stop_pos in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: The SAS System stopped processing this step because of errors.
NOTE: SAS set option OBS=0 and will continue to check statements. This might cause NOTE: No observations in data set.
WARNING: The data set WORK.METHYLATION_REGIONS may be incomplete.  When this step was stopped there were 0 observations and 2 
         variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

958        
959        
960        data ca_regions;
961           set group_dac2;
962           length regionID $100.;
963           regionID=catx("|", site_type, chr, region_num);
964           keep chr start_pos stop_pos regionID;
965        run;

38                                                         The SAS System                               13:30 Monday, April 17, 2023

NOTE: The data set WORK.CA_REGIONS has 0 observations and 4 variables.
NOTE: DATA statement used (Total process time):
      real time           0.06 seconds
      cpu time            0.01 seconds
      

966        
967        
968        proc sort data=methylation_regions nodup;
969          by chr start_pos stop_pos regionID;
ERROR: Variable START_POS not found.
ERROR: Variable STOP_POS not found.

NOTE: The SAS System stopped processing this step because of errors.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      


970        proc sort data=ca_regions nodup;
971          by chr start_pos stop_pos regionID;
972        run;

NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

973        
NOTE: PROCEDURE EXPORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
974        proc export data=methylation_regions outfile="/blue/concannon/share/jnewman/mingqi_arab/Br_meth_regions_final.bed"
975          dbms=tab replace;

975      !                     putnames=no;
                               ________
                               180

ERROR 180-322: Statement is not valid or it is used out of proper order.

976        run;
977        
NOTE: PROCEDURE EXPORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      
978        proc export data=ca_regions outfile="/blue/concannon/share/jnewman/mingqi_arab/Br_acc_regions_final.bed"
979          dbms=tab replace;

979      !                     putnames=no;
                               ________
                               180

ERROR 180-322: Statement is not valid or it is used out of proper order.

39                                                         The SAS System                               13:30 Monday, April 17, 2023

980        run;
981        
982        

ERROR: Errors printed on pages 37,38.

NOTE: SAS Institute Inc., SAS Campus Drive, Cary, NC USA 27513-2414
NOTE: The SAS System used:
      real time           5:20:47.46
      cpu time            5:09:11.61
      
